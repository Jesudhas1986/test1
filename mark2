import os
import markdown

def convert_md_to_html_preserve_structure(source_dir, output_dir):
    for root, _, files in os.walk(source_dir):
        for file in files:
            if file.endswith(".md"):
                # Full path to source file
                source_path = os.path.join(root, file)

                # Compute relative path from source_dir
                rel_path = os.path.relpath(source_path, source_dir)

                # Change extension to .html
                rel_html_path = os.path.splitext(rel_path)[0] + ".html"

                # Destination full path
                dest_path = os.path.join(output_dir, rel_html_path)

                # Make sure destination directory exists
                os.makedirs(os.path.dirname(dest_path), exist_ok=True)

                # Read Markdown and convert
                with open(source_path, "r", encoding="utf-8") as f:
                    md_text = f.read()
                html_text = markdown.markdown(md_text)

                # Write to destination
                with open(dest_path, "w", encoding="utf-8") as f:
                    f.write(html_text)

                print(f"Converted: {source_path} â†’ {dest_path}")

# Example usage
convert_md_to_html_preserve_structure("source_dir", "output_dir")
